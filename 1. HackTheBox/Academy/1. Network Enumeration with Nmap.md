# Firewall and IDS/IPS Evasion - Easy Lab

Now let's get practical. A company hired us to test their IT security defenses, including their `IDS` and `IPS` systems. Our client wants to increase their IT security and will, therefore, make specific improvements to their `IDS/IPS` systems after each successful test. We do not know, however, according to which guidelines these changes will be made. Our goal is to find out specific information from the given situations.

We are only ever provided with a machine protected by `IDS/IPS` systems and can be tested. For learning purposes and to get a feel for how `IDS/IPS` can behave, we have access to a status web page at:
  ![](../../../Image/Pasted%20image%2020250504211108.png)
  
This page shows us the number of alerts. We know that if we receive a specific amount of alerts, we will be `banned`. Therefore we have to test the target system as `quietly` as possible.

```ad-question
Our client wants to know if we can identify which operating system their provided machine is running on. Submit the OS name as the answer.
```

```
sudo nmap -sS -Pn -n 10.129.2.80 -A
```
**=> Ubuntu**

---
# Firewall and IDS/IPS Evasion - Medium Lab

After we conducted the first test and submitted our results to our client, the administrators made some changes and improvements to the `IDS/IPS` and firewall. We could hear that the administrators were not satisfied with their previous configurations during the meeting, and they could see that the network traffic could be filtered more strictly.

```ad-note
To successfully solve the exercise, we must use the UDP protocol on the VPN.
```

```ad-question
After the configurations are transferred to the system, our client wants to know if it is possible to find out our target's DNS server version. Submit the DNS server version of the target as the answer.
```

```
sudo nmap -sU -Pn -n 10.129.116.199 -A -p53
```
**=> HTB{GoTtgUnyze9Psw4vGjcuMpHRp}**

---
# Firewall and IDS/IPS Evasion - Hard Lab

With our second test's help, our client was able to gain new insights and sent one of its administrators to a `training course` for `IDS/IPS` systems. As our client told us, the training would last `one week`. Now the administrator has taken all the necessary precautions and wants us to test this again because specific services must be changed, and the communication for the provided software had to be modified.

```ad-question
Now our client wants to know if it is possible to find out the version of the running services. Identify the version of service our client was talking about and submit the flag as the answer.
```

```
sudo nmap -sS -Pn -n 10.129.97.253 -A --source-port 53 -vvv -p50000
```
- Still don't show the version
```
PORT      STATE SERVICE    REASON         VERSION
50000/tcp open  tcpwrapped syn-ack ttl 63
|_drda-info: TIMEOUT
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
```

- Connect the service via 53 port.
```
nc 10.129.97.253 50000 -p 53
```
=> **HTB{kjnsdf2n982n1827eh76238s98di1w6}**
